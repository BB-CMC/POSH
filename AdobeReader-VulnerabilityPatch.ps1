Set-ExecutionPolicy -ExecutionPolicy Bypass -Scope Process -Force -Confirm:$false
$ErrorActionPreference = "SilentlyContinue"

$installed = @()
Try{
    $installed = Get-ChildItem -Path HKLM:\SOFTWARE\Microsoft\Windows\CurrentVersion\Uninstall, `
    HKLM:\SOFTWARE\Wow6432Node\Microsoft\Windows\CurrentVersion\Uninstall | Get-ItemProperty | Select-Object -Property DisplayName, UninstallString, Version | Sort DisplayName
} 
Catch [Exception] 
{ }

$AReader_Uninstall = $installed -like "*Adobe Acrobat Reader*"

$switchObj = $AReader_Uninstall.Item(0)
$string = $switchObj.ToString()

$split = @()
$split = $string -split {$_ -eq "="}

$installString = $split | Where-Object {($_ -like "MsiExec.exe*")}
$uninstall = $installString.Replace("MsiExec.exe /I", "/X ")
$uninstallString = $uninstall.TrimEnd("; Version")


$reader_Info = $AReader_Uninstall.GetValue(0)
$nexvar = $reader_Info.TrimStart("@{DisplayName=Adobe Acrobat Reader DC MUI; UninstallString=MsiExec.exe /I{AC76BA86-7AD7-FFFF-7B44-AC0F074E4100}; Version=")
$reader_Version = $nexvar.TrimEnd("}")

if(($uninstallString -ne $null) -and ($reader_Version -ne "352669276")) {
    Start-Process MsiExec.exe -Verb RunAs -ArgumentList "/c /qn $uninstallString" -PassThru -ErrorAction Inquire

}
